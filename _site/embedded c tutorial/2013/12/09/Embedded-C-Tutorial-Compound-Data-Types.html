
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Compound Data Types</title> 
<meta name="author" content="Stratify Labs, Inc">

<!-- Enable responsive viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Le styles -->
<link href="/assets/themes/twitter}/bootstrap3/css/bootstrap.min.css" rel="stylesheet">
<script src="/assets/themes/twitter}/bootstrap3/js/jquery-2.0.3.min.js"></script>
<script src="/assets/themes/twitter}/bootstrap3/js/bootstrap.min.js"></script>
<link href="/assets/themes/twitter}/bootstrap3/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/themes/twitter}/css/style.css" rel="stylesheet">
<link href="/assets/themes/twitter}/css/syntax.css" rel="stylesheet">
<script src="/assets/themes/twitter}/js/application.js"></script>

<!-- Le fav and touch icons -->
<!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

<!-- atom & rss feed -->
<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

</head>
<body style="min-height: 200px; padding-top: 50px;">
	<header class="navbar navbar-default navbar-fixed-top bs-docs-nav" role="banner">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="navbar-header">
						<button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".menu-navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/index.html">
							<img style="height: 22px;" src="/images/Stratify-Labs-Logo.svg" />
						</a>
					</div>

					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse menu-navbar-collapse" role="navigation">
						<ul class="nav navbar-nav">
							<li><a href="https://github.com/StratifyLabs"><i class="fa fa-code-fork"></i> Code</a></li>
							<li><a href="/tips.html"><i class="fa fa-exclamation-circle"></i> Design Tips</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>

	<a class="anchor" id="top"></a>


	<div class="content" id="content">
		


<div class="container">
	<div class="row" style="margin-top: 20px;">
		<div class="col-md-8">
					<h1>
						Compound Data Types <small>Embedded C Tutorial</small>
					</h1>
					<p>The C languages defines several types of compound data structures. The structures treat the data differently when stored in memory. The following compound data types exist.</p>

<ul>
  <li>struct: data in a struct is allocated contiguously in memory</li>
  <li>union: data in a union occupy the same memory location</li>
  <li>enum: this is a list of valid values for the specified type</li>
</ul>

<p>C also provides two important tools for programmers that allow them to define new data types (using typedef) and check the size of existing types (using sizeof).</p>

<h3 id="struct">struct</h3>

<p>Of these types the struct is the most commonly used. In programming design, related data is combined in a struct. The C language, per se, does not define any structâ€™s. However, the C standard library defines a number of them. A good example of this is struct tm which is the data structure for storing calendar time. The following code segment shows how the structure is defined (part of the time.h header).</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">struct</span> <span class="n">tm</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">tm_sec</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_min</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_hour</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_mday</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_mon</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_year</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_wday</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_yday</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tm_isdst</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>The program below shows how to access (read and write) members of a struct using the period (.) syntax to access members.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;  //"struct tm" is defined here 
</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span> 
     <span class="k">struct</span> <span class="n">tm</span> <span class="n">t</span><span class="p">;</span> <span class="c1">//declare t as a struct tm 
</span>     <span class="n">t</span><span class="p">.</span><span class="n">tm_sec</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> <span class="c1">//assign 30 to the tm_sec member 
</span>     <span class="n">t</span><span class="p">.</span><span class="n">tm_min</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">//assign 5 to the tm_min member 
</span>     <span class="n">t</span><span class="p">.</span><span class="n">tm_hour</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">//assign 10 to the tm_hour member 
</span>     <span class="n">printf</span><span class="p">(</span><span class="s">"time is %d:%d:%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="n">tm_hour</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="n">tm_min</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="n">tm_sec</span><span class="p">);</span> 
     <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="p">}</span></code></pre></figure>

<p>This program ouputs:</p>

<pre>
time is 10:5:30
union
</pre>

<p>The syntax for union is similar to that of struct. However, the memory allocation for a union is very different. For a struct, each member is assigned a unique location in memory, but all members of a union share the same memory location. The size of the union in memory is at least large enough to hold the largest member.</p>

<h3 id="enum">enum</h3>

<p>An enum is a list of values that should be assigned to a variable. An enum variable occupies enough memory to hold the largest value of the enum and has values rather than members (unlike union and struct). Using enum is equivalent to using an integer type large enough to hold all enum values. The compiler does not ensure that values assigned to enum types are in the list.</p>

<h2 id="combining-compound-data-types">Combining Compound Data Types</h2>

<p>Compound data types (specifically, unions and structs) can be combined in various ways. There can be unions within structs, vice versa, and almost any other combination. The following code shows a couple of examples.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdlib.h&gt;
</span><span class="k">struct</span> <span class="n">point</span> <span class="p">{</span> 
     <span class="c1">//This structure has location and color data 
</span>     <span class="kt">int</span> <span class="n">x</span><span class="p">;</span> 
     <span class="kt">int</span> <span class="n">y</span><span class="p">;</span> 
     <span class="kt">int</span> <span class="n">z</span><span class="p">;</span> 
     <span class="k">union</span> <span class="n">color_union</span> <span class="p">{</span> <span class="c1">//The color data can be accesses as elements or one number               struct rgb_struct { 
</span>                <span class="kt">uint8_t</span> <span class="n">r</span><span class="p">;</span> <span class="c1">//red element 
</span>                <span class="kt">uint8_t</span> <span class="n">g</span><span class="p">;</span> <span class="c1">//green element 
</span>                <span class="kt">uint8_t</span> <span class="n">b</span><span class="p">;</span> <span class="c1">//blue element 
</span>                <span class="kt">uint8_t</span> <span class="n">alpha</span><span class="p">;</span> <span class="c1">//transparency element 
</span>          <span class="p">}</span> <span class="n">rgb</span><span class="p">;</span> 
          <span class="kt">uint32_t</span> <span class="n">rgba</span><span class="p">;</span> <span class="c1">//rgb and transparency elements 
</span>     <span class="p">}</span> <span class="n">color</span><span class="p">;</span> <span class="p">};</span> 
 
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span> 
     <span class="k">struct</span> <span class="n">point</span> <span class="n">p0</span><span class="p">;</span> 
     <span class="n">p0</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> 
     <span class="n">p0</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span> 
     <span class="n">p0</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span> 
     <span class="n">p0</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span><span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span> 
     <span class="n">p0</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span><span class="p">.</span><span class="n">g</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
     <span class="n">p0</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
     <span class="n">p0</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span><span class="p">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span> 
     <span class="n">printf</span><span class="p">(</span><span class="s">"%d,%d,%d %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p0</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">.</span><span class="n">z</span><span class="p">,</span> <span class="n">p0</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgba</span><span class="p">);</span> 
     <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> 
<span class="p">}</span></code></pre></figure>

<p>In this example, there is a struct within a union within a struct. When p0 is assigned memory, it has the following layout assuming int is four bytes:</p>

<p><img class="post_image" src="/images/memory-layout.svg" /></p>

<h3 id="type-definitions">Type Definitions</h3>

<p>Users (C Programmers) can define types using any raw or compound data type as well as previously defined user types. The stdint.h header is a good example of user-defined types using purely raw data types. The code snippet below shows a partial, simplied implemenation of stdint.h on a 32-bit processor.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#ifndef _STDINT_H  //this is the header guard
#define _STDINT_H
</span><span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="kt">uint32_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">int</span> <span class="kt">int32_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="kt">uint8_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">char</span> <span class="kt">int8_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="kt">uint16_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">short</span> <span class="kt">int16_t</span><span class="p">;</span>
<span class="cp">#endif</span></code></pre></figure>

<p>Since this is a header file, the first thing is the header guard as mentioned in the preprocessor directives lesson. Next, the typedef keyword is introduced which defines a new data type than can be declared just like any other data type. The example then uses raw types to define the C99 integers in stdint.h. The code below illustrates the use of these types alongside raw types; it also introduces a new C keyword: sizeof.</p>

<figure class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;  
#include &lt;stdint.h
</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span> 
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">x</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">y</span><span class="p">;</span> <span class="c1">//x and y are the same type on most processors 
</span>	<span class="kt">int</span> <span class="n">w</span><span class="p">;</span> 
	<span class="kt">int32_t</span> <span class="n">z</span><span class="p">;</span> <span class="c1">//show the sizes (number of bytes in memory) used by each variable 
</span>	<span class="n">printf</span><span class="p">(</span><span class="s">"sizeof(x) is %d, sizeof(y) is %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">y</span><span class="p">));</span> 
	<span class="n">printf</span><span class="p">(</span><span class="s">"sizeof(w) is %d, sizeof(z) is %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">z</span><span class="p">));</span> 
	<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>As shown, uint8_t can be used just like unsigned char after the typedef unsigned char uint8_t line which is located in stdint.h. The program has the following output showing that the uint8_t/unsigned char types use one byte in memory while the int32_t/int types use four bytes in memory.</p>

<pre>
sizeof(x) is 1, sizeof(y) is 1
sizeof(w) is 4, sizeof(z) is 4
</pre>

<p>The sizeof keyword can operate both on types and variables. The example above uses the variable, for example sizeof(x). But it is also OK to use sizeof(unsigned char). The sizeof keyword is especially useful with structs. For the calendar time struct mentioned above, we use sizeof(struct tm). This notation is used when the struct has not been defined as a type using typedef.</p>

<h2 id="take-away">Take Away</h2>

<p>Compound data types in C give the programmer a powerful set of tools for organizing data. The C struct is the most common compound data type and organizes data contiguously in memory. A union allows the same place in memory to be treated as different types. An enum defines a list of values but acts more like a macro (see #define) than a compound data type. Users can also create customized types using the typedef keyword. Finally, the sizeof keyword determines the amount of memory used by a variable or type.</p>



			
			<ul class="nav nav-pills">
				
				


  
     
    	<li><a href="/tags.html#embedded-ref">embedded <span class="badge">11</span></a></li>
     
    	<li><a href="/tags.html#tutorial-ref">tutorial <span class="badge">10</span></a></li>
    
  



			</ul>
			
			<div class="pagination">
				<center>
					 
						<a href="/embedded%20c%20tutorial/2013/12/08/Embedded-C-Tutorial-Preprocessor" type="button" class="btn btn-primary"
							data-toggle="tooltip" data-placement="left" title="" data-original-title="Previous Post"
							>
							<i class="fa fa-arrow-left"></i>
						</a> 
					 
					<a href="/archive.html" type="button" class="btn btn-primary"
						data-toggle="tooltip" data-placement="top" title="" data-original-title="Archives"
						>
						<i class="fa fa-archive"></i>
					</a> 
					<a href="/categories.html" type="button" class="btn btn-primary"
						data-toggle="tooltip" data-placement="top" title="" data-original-title="Categories"
					>
						<i class="fa fa-folder-open"></i>
					</a> 
					 
						<a href="/embedded%20c%20tutorial/2013/12/10/Embedded-C-Tutorial-Keyword-Reference" type="button" class="btn btn-primary"
							data-toggle="tooltip" data-placement="right" title="" data-original-title="Next Post"
							>
							<i class="fa fa-arrow-right"></i>
						</a>
					
				</center>
			</div>
				
		</div>
		<div class="col-md-4">
		

			<h3>Embedded C Tutorial</h3>
			<ul class="nav nav-pills nav-stacked">
				
				
				


  



			</ul>

			
			
			  
		</div>
	</div>

</div>



	</div>

	<footer style="background: #344555; color: #fff;">
		<div class="container">
			<div class="row" style="margin-top: 20px; margin-bottom: 20px; ">
				<div class="col-md-12">
					<p>&copy; 2016 Stratify Labs, Inc</p>
				</div>
			</div>
		</div>
	</footer>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75152879-1', 'stratifylabs.co');
  ga('send', 'pageview');

</script>
 </body>
</html>

