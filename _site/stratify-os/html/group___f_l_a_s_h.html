
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CoActionOS Docs</title> 
<meta name="author" content="Stratify Labs, Inc">

<!-- Enable responsive viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Le styles -->
<link href="/assets/themes/twitter/bootstrap3/css/bootstrap.min.css" rel="stylesheet">
<script src="/assets/themes/twitter/bootstrap3/js/jquery-2.0.3.min.js"></script>
<script src="/assets/themes/twitter/bootstrap3/js/bootstrap.min.js"></script>
<link href="/assets/themes/twitter/bootstrap3/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/themes/twitter/css/style.css" rel="stylesheet">
<link href="/assets/themes/twitter/css/syntax.css" rel="stylesheet">
<script src="/assets/themes/twitter/js/application.js"></script>

<!-- Le fav and touch icons -->
<!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

<!-- atom & rss feed -->
<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

</head>
<body style="min-height: 200px; padding-top: 50px;">
	<header class="navbar navbar-default navbar-fixed-top bs-docs-nav" role="banner">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="navbar-header">
						<button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".menu-navbar-collapse">
							<span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/index.html">
							<img style="height: 22px;" src="/images/Stratify-Labs-Logo.svg" />
						</a>
					</div>

					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse menu-navbar-collapse" role="navigation">
						<ul class="nav navbar-nav">
							<li><a href="https://github.com/StratifyLabs"><i class="fa fa-code-fork"></i> Code</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>

	<a class="anchor" id="top"></a>


	<div class="content" id="content">
		


<div class="container">
	<div class="row" style="margin-top: 20px;">
		<div class="col-md-offset-1 col-md-10">
			<div>
				
<script type="text/javascript" src="doxy-boot.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">Flash Memory<div class="ingroups"><a class="el" href="group___p_e_r_i_p_h_i_o.html">Peripheral Input/Output</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Flash Memory:</div>
<div class="dyncontent">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="group___f_l_a_s_h.svg" width="326" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</td></tr></table></center>
</div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The flash memory software module allows the user code to read memory in the flash program space. Reading the flash is portable across all supported MCU's. However, writing the flash is dependent on the MCU page size.</p>
<p>This interface is typically only used with the bootloader. The preferred way to access the flash is using the <a class="el" href="group___m_e_m.html">Memory (RAM/Flash)</a> interface. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflash__pageinfo__t.html">flash_pageinfo_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash page info for use with I_FLASH_GETPAGEINFO.  <a href="structflash__pageinfo__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflash__writepage__t.html">flash_writepage_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash page write data using I_FLASH_WRITEPAGE.  <a href="structflash__writepage__t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gabbc7be7259603befa91cf82a53635026"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gabbc7be7259603befa91cf82a53635026">FLASH_MIN_WRITE_SIZE</a></td></tr>
<tr class="memdesc:gabbc7be7259603befa91cf82a53635026"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gabbc7be7259603befa91cf82a53635026">More...</a><br/></td></tr>
<tr class="separator:gabbc7be7259603befa91cf82a53635026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae34a1428457cec34e25242f1051a1c08"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gae34a1428457cec34e25242f1051a1c08">FLASH_MAX_WRITE_SIZE</a></td></tr>
<tr class="memdesc:gae34a1428457cec34e25242f1051a1c08"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gae34a1428457cec34e25242f1051a1c08">More...</a><br/></td></tr>
<tr class="separator:gae34a1428457cec34e25242f1051a1c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3269de27e06da94d3563f22fed34ece4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga3269de27e06da94d3563f22fed34ece4">I_FLASH_ERASEADDR</a></td></tr>
<tr class="memdesc:ga3269de27e06da94d3563f22fed34ece4"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga3269de27e06da94d3563f22fed34ece4">More...</a><br/></td></tr>
<tr class="separator:ga3269de27e06da94d3563f22fed34ece4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab0cd3a8e3488ddeec35887ef0c7b6eb1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gab0cd3a8e3488ddeec35887ef0c7b6eb1">I_FLASH_ERASEPAGE</a></td></tr>
<tr class="memdesc:gab0cd3a8e3488ddeec35887ef0c7b6eb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gab0cd3a8e3488ddeec35887ef0c7b6eb1">More...</a><br/></td></tr>
<tr class="separator:gab0cd3a8e3488ddeec35887ef0c7b6eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8680be69eaa74f57f2853d68592811a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga8680be69eaa74f57f2853d68592811a8">I_FLASH_GETPAGE</a></td></tr>
<tr class="memdesc:ga8680be69eaa74f57f2853d68592811a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga8680be69eaa74f57f2853d68592811a8">More...</a><br/></td></tr>
<tr class="separator:ga8680be69eaa74f57f2853d68592811a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb">I_FLASH_GETSIZE</a></td></tr>
<tr class="memdesc:ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb">More...</a><br/></td></tr>
<tr class="separator:ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf80a88a4fe4da955323e71c1a5f821b0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gaf80a88a4fe4da955323e71c1a5f821b0">I_FLASH_GETPAGEINFO</a></td></tr>
<tr class="memdesc:gaf80a88a4fe4da955323e71c1a5f821b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gaf80a88a4fe4da955323e71c1a5f821b0">More...</a><br/></td></tr>
<tr class="separator:gaf80a88a4fe4da955323e71c1a5f821b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a6e7b8fae0b172931a6b884351f9d15"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga1a6e7b8fae0b172931a6b884351f9d15">I_FLASH_WRITEPAGE</a></td></tr>
<tr class="memdesc:ga1a6e7b8fae0b172931a6b884351f9d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga1a6e7b8fae0b172931a6b884351f9d15">More...</a><br/></td></tr>
<tr class="separator:ga1a6e7b8fae0b172931a6b884351f9d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gae34a1428457cec34e25242f1051a1c08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_MAX_WRITE_SIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This defines the MCU specific value for the maximum write size for a flash operation. </p>

</div>
</div>
<a class="anchor" id="gabbc7be7259603befa91cf82a53635026"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_MIN_WRITE_SIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This defines the MCU specific value for the minimum write size. This is also the minimum step and alignment size for writing the flash. </p>

</div>
</div>
<a class="anchor" id="ga3269de27e06da94d3563f22fed34ece4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_ERASEADDR</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request erases the page containing the specified address. The address is specified as the ctl argument.</p>
<div class="fragment"><div class="line"><a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(flash_fd, <a class="code" href="group___f_l_a_s_h.html#ga3269de27e06da94d3563f22fed34ece4">I_FLASH_ERASEADDR</a>, (<span class="keywordtype">void</span>*)0x00001000 );</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gab0cd3a8e3488ddeec35887ef0c7b6eb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_ERASEPAGE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request erases the page number specified by the ctl argument.</p>
<p>Example: </p>
<div class="fragment"><div class="line"><a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(flash_fd, <a class="code" href="group___f_l_a_s_h.html#gab0cd3a8e3488ddeec35887ef0c7b6eb1">I_FLASH_ERASEPAGE</a>, 3); <span class="comment">//erase page 3</span></div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga8680be69eaa74f57f2853d68592811a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_GETPAGE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request gets the page number for the specified address. The ctl argument is the address and the return value is the page.</p>
<p>Example: </p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> page;</div>
<div class="line">page = <a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(flash_fd, <a class="code" href="group___f_l_a_s_h.html#ga8680be69eaa74f57f2853d68592811a8">I_FLASH_GETPAGE</a>, (<span class="keywordtype">void</span>*)0x00001000 );</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaf80a88a4fe4da955323e71c1a5f821b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_GETPAGEINFO</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request gets the page number for the specified address. The ctl argument is the address and the return value is the page.</p>
<p>Example: </p>
<div class="fragment"><div class="line"><a class="code" href="structflash__pageinfo__t.html">flash_pageinfo_t</a> pageinfo;</div>
<div class="line">page = <a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(flash_fd, <a class="code" href="group___f_l_a_s_h.html#gaf80a88a4fe4da955323e71c1a5f821b0">I_FLASH_GETPAGEINFO</a>, &amp;pageinfo );</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_GETSIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request gets the page number for the specified address. The ctl argument is the address and the return value is the page.</p>
<p>Example: </p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> page;</div>
<div class="line">size = <a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(flash_fd, I_FLASH_GET_PAGE);</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga1a6e7b8fae0b172931a6b884351f9d15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_WRITEPAGE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request is used to write a page to the flash memory. </p>
<div class="fragment"><div class="line"><a class="code" href="structflash__writepage__t.html">flash_writepage_t</a> pwrite;</div>
<div class="line">pwrite.<a class="code" href="structflash__writepage__t.html#a16dd68943e26f3a21b35aaf6bd97ab7e">addr</a> = 0x1000; <span class="comment">//this should be on a boundary for the minimum page size</span></div>
<div class="line">pwrite.<a class="code" href="structflash__writepage__t.html#acad39d3514dd3a45a0f01c65e9e57a03">nbyte</a> = 256;  <span class="comment">//This has to be a valid page write value for the architecture</span></div>
<div class="line">memcpy(pwrite.<a class="code" href="structflash__writepage__t.html#ada65fc394b82ba0c36d1fc15f03eef58">buf</a>, my_data, pwrite.<a class="code" href="structflash__writepage__t.html#acad39d3514dd3a45a0f01c65e9e57a03">nbyte</a>);</div>
<div class="line"><a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(flash_fd, <a class="code" href="group___f_l_a_s_h.html#ga1a6e7b8fae0b172931a6b884351f9d15">I_FLASH_WRITEPAGE</a>, &amp;pwrite);</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->

			</div>
		</div>
	</div>
</div>



	</div>

	<footer style="background: #344555; color: #fff;">
		<div class="container">
			<div class="row" style="margin-top: 20px; margin-bottom: 20px; ">
				<div class="col-md-12">
					<p>&copy; 2016 Stratify Labs, Inc</p>
				</div>
			</div>
		</div>
	</footer>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-21543723-3', 'coactionos.com');
  ga('send', 'pageview');

</script>
 </body>
</html>

