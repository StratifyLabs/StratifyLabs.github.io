---
layout: page
title: Stratify OS Docs
---
{% include JB/setup %}
<script type="text/javascript" src="doxy-boot.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_fmt.html">Fmt</a></li><li class="navelem"><a class="el" href="class_fmt_1_1_son.html">Son</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="class_fmt_1_1_son-members.html">List of all members</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">Fmt::Son&lt; stacksize &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Stratify Object Notation.  
 <a href="class_fmt_1_1_son.html#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;int stacksize&gt;<br />
class Fmt::Son&lt; stacksize &gt;</h3>

<p>The SON (Stratify Object Notation) is an important class to be familiar with. It is closely related to JSON (and very closely related to BSON). It allows you to store, access, and modify data in the same way you but is designed for use on resource constrained systems.</p>
<p>Important things to note:</p><ul>
<li>Key names are limited to 7 characters (longer names are truncated)</li>
<li>The stacksize template value is the depth limit when creating files</li>
<li>You can only append to files that are left with an open ended array</li>
<li>You can't modify the length of strings or data objects within a file</li>
<li>You must create "root" as the first object or array</li>
</ul>
<p>Creation example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stfy/Fmt.hpp&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[]){</div><div class="line">     Son son&lt;4&gt;; <span class="comment">//depth is limited to 4</span></div><div class="line"></div><div class="line">  <span class="comment">//tabs are added to help visualize the parallel to JSON</span></div><div class="line">     son.create(<span class="stringliteral">&quot;/home/settings.son&quot;</span>);</div><div class="line">          son.open_obj(<span class="stringliteral">&quot;root&quot;</span>);</div><div class="line">               son.write(<span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;Stratify&quot;</span>); <span class="comment">//create a string</span></div><div class="line">               son.write(<span class="stringliteral">&quot;date&quot;</span>, <span class="stringliteral">&quot;today&quot;</span>); <span class="comment">//makes sense</span></div><div class="line">               son.write(<span class="stringliteral">&quot;value&quot;</span>, (u32)100); <span class="comment">//write a number);</span></div><div class="line">               son.open_obj(<span class="stringliteral">&quot;stuff&quot;</span>);</div><div class="line">                    son.write(<span class="stringliteral">&quot;hour&quot;</span>, 12);</div><div class="line">                    son.write(<span class="stringliteral">&quot;min&quot;</span>, 00);</div><div class="line">                    son.write(<span class="stringliteral">&quot;sec&quot;</span>, 59);</div><div class="line">               son.close_obj();</div><div class="line">          son.close_obj();</div><div class="line">     son.close();</div><div class="line"></div><div class="line">     <span class="keywordtype">char</span> buffer[32];</div><div class="line">     u32 value;</div><div class="line">     son.open(<span class="stringliteral">&quot;/home/settings.son&quot;</span>); <span class="comment">//opens read-only</span></div><div class="line"></div><div class="line">     son.read_str(<span class="stringliteral">&quot;name&quot;</span>, buffer, 32);</div><div class="line">     <span class="comment">//buffer holds &quot;Stratify&quot;</span></div><div class="line"></div><div class="line">     value = son.read_unum(<span class="stringliteral">&quot;hour&quot;</span>);</div><div class="line">     son.read_str(<span class="stringliteral">&quot;sec&quot;</span>, buffer, 32);</div><div class="line">     <span class="comment">//buffer holds &quot;59&quot;</span></div><div class="line"></div><div class="line">     son.to_json(<span class="stringliteral">&quot;/home.settings.json&quot;</span>);</div><div class="line">     son.close();</div><div class="line"></div><div class="line">     }</div></div><!-- fragment --><p>The settings.json files looks like: </p><pre class="fragment">{
    "name": "Stratify",
    "date": "today",
    "value": "100",
    "stuff": {
        "hour": "12",
        "min": "0",
        "sec": "59"
     }
 }
</pre><p>} </p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a176ff79289597040b223d6004319417a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#a176ff79289597040b223d6004319417a">fileno</a> () const </td></tr>
<tr class="memdesc:a176ff79289597040b223d6004319417a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The file descriptor of the SON file.  <a href="#a176ff79289597040b223d6004319417a">More...</a><br /></td></tr>
<tr class="separator:a176ff79289597040b223d6004319417a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a0945480cf3c709e51e54262853dff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#ae8a0945480cf3c709e51e54262853dff">create</a> (const char *name)</td></tr>
<tr class="memdesc:ae8a0945480cf3c709e51e54262853dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new SON file.  <a href="#ae8a0945480cf3c709e51e54262853dff">More...</a><br /></td></tr>
<tr class="separator:ae8a0945480cf3c709e51e54262853dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0266307a9e07d25b597cef147c533e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3d0266307a9e07d25b597cef147c533e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#a3d0266307a9e07d25b597cef147c533e">to_json</a> (const char *path)</td></tr>
<tr class="memdesc:a3d0266307a9e07d25b597cef147c533e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the data file to JSON. <br /></td></tr>
<tr class="separator:a3d0266307a9e07d25b597cef147c533e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c0f6b7128519dad16af540115a2dbb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a64c0f6b7128519dad16af540115a2dbb"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#a64c0f6b7128519dad16af540115a2dbb">open_obj</a> (const char *key)</td></tr>
<tr class="memdesc:a64c0f6b7128519dad16af540115a2dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open an object. <br /></td></tr>
<tr class="separator:a64c0f6b7128519dad16af540115a2dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0dc6eb7aa5eef78feff4589b3d3fcee"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af0dc6eb7aa5eef78feff4589b3d3fcee"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#af0dc6eb7aa5eef78feff4589b3d3fcee">close_obj</a> ()</td></tr>
<tr class="memdesc:af0dc6eb7aa5eef78feff4589b3d3fcee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close an object. <br /></td></tr>
<tr class="separator:af0dc6eb7aa5eef78feff4589b3d3fcee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29690182d14b1b314744d5ca9f3f4d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa29690182d14b1b314744d5ca9f3f4d2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#aa29690182d14b1b314744d5ca9f3f4d2">open_array</a> (const char *key, int fixed_size=0)</td></tr>
<tr class="memdesc:aa29690182d14b1b314744d5ca9f3f4d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open an object. <br /></td></tr>
<tr class="separator:aa29690182d14b1b314744d5ca9f3f4d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afebbb8e5287cc8dbe209c525916b360c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afebbb8e5287cc8dbe209c525916b360c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#afebbb8e5287cc8dbe209c525916b360c">close_array</a> ()</td></tr>
<tr class="memdesc:afebbb8e5287cc8dbe209c525916b360c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close an array. <br /></td></tr>
<tr class="separator:afebbb8e5287cc8dbe209c525916b360c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c171457e92bb0aa351ee1ec0df2f31"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae8c171457e92bb0aa351ee1ec0df2f31"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#ae8c171457e92bb0aa351ee1ec0df2f31">open_data</a> (const char *key)</td></tr>
<tr class="memdesc:ae8c171457e92bb0aa351ee1ec0df2f31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open a data object. <br /></td></tr>
<tr class="separator:ae8c171457e92bb0aa351ee1ec0df2f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7474b8ae6e2ab8e4e71a6b5cc175568b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7474b8ae6e2ab8e4e71a6b5cc175568b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#a7474b8ae6e2ab8e4e71a6b5cc175568b">close_data</a> ()</td></tr>
<tr class="memdesc:a7474b8ae6e2ab8e4e71a6b5cc175568b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close a data object. <br /></td></tr>
<tr class="separator:a7474b8ae6e2ab8e4e71a6b5cc175568b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a122ef6bbc9351d3c48885b4c2a1ff271"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#a122ef6bbc9351d3c48885b4c2a1ff271">write</a> (const char *key, const char *v)</td></tr>
<tr class="memdesc:a122ef6bbc9351d3c48885b4c2a1ff271"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a string.  <a href="#a122ef6bbc9351d3c48885b4c2a1ff271">More...</a><br /></td></tr>
<tr class="separator:a122ef6bbc9351d3c48885b4c2a1ff271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5d898303e51b973dba81ea38bc9494"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_fmt_1_1_son.html#a7b5d898303e51b973dba81ea38bc9494">write</a> (const char *key, i32 v)</td></tr>
<tr class="memdesc:a7b5d898303e51b973dba81ea38bc9494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a number.  <a href="#a7b5d898303e51b973dba81ea38bc9494">More...</a><br /></td></tr>
<tr class="separator:a7b5d898303e51b973dba81ea38bc9494"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae8a0945480cf3c709e51e54262853dff"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int stacksize&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_fmt_1_1_son.html">Fmt::Son</a>&lt; stacksize &gt;::create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success </dd></dl>

</div>
</div>
<a class="anchor" id="a176ff79289597040b223d6004319417a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int stacksize&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_fmt_1_1_son.html">Fmt::Son</a>&lt; stacksize &gt;::fileno </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>SON File descriptor </dd></dl>

</div>
</div>
<a class="anchor" id="a122ef6bbc9351d3c48885b4c2a1ff271"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int stacksize&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_fmt_1_1_son.html">Fmt::Son</a>&lt; stacksize &gt;::write </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The value key </td></tr>
    <tr><td class="paramname">v</td><td>A pointer to the string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes in the value portion to be successfully stored </dd></dl>

</div>
</div>
<a class="anchor" id="a7b5d898303e51b973dba81ea38bc9494"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int stacksize&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_fmt_1_1_son.html">Fmt::Son</a>&lt; stacksize &gt;::write </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">i32&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The value key </td></tr>
    <tr><td class="paramname">v</td><td>The number to write </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes stored (4) if successful </dd></dl>

</div>
</div>
</div><!-- contents -->
