---
layout: page
title: Stratify OS Docs
---
{% include JB/setup %}
<script type="text/javascript" src="doxy-boot.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">Ethernet Device Access<div class="ingroups"><a class="el" href="group___s_t_f_y.html">Stratify OS</a> &raquo; <a class="el" href="group___i_f_a_c_e___d_e_v.html">Device Interface</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The ethernet driver provides access to an ethernet device.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> fd;</div><div class="line"></div><div class="line"> <span class="comment">//open and init ethernet driver</span></div><div class="line"></div><div class="line"> <span class="comment">//sending packets: initialize TX, write data, send packet</span></div><div class="line"><a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(fd, <a class="code" href="group___e_t_h___d_e_v.html#ga1c9146612934f92e865882fc6cdfab7e">I_ETH_INITTXPKT</a>); <span class="comment">//prepare transmission</span></div><div class="line"><a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#gadd30ddeed4bdbf3c96fa36970c1ca778">write</a>(fd, eth_buffer, eth_size); <span class="comment">//write to buffers</span></div><div class="line"><a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(fd, <a class="code" href="group___e_t_h___d_e_v.html#gaf49e4783348012ba8cd1abe757e66f5a">I_ETH_SENDTXPKT</a>); <span class="comment">//send the packet</span></div><div class="line"></div><div class="line"> <span class="comment">//receiving packets</span></div><div class="line"> <span class="keywordtype">int</span> len;</div><div class="line"> uint32_t addr;</div><div class="line"> len = <a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(fd, <a class="code" href="group___e_t_h___d_e_v.html#ga3f87af45b40ab74852e3571e370ccd5a">I_ETH_RXPKTRDY</a>, &amp;addr);</div><div class="line"> <span class="keywordflow">if</span>( len &gt; 0 ){</div><div class="line">     <a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#gaefe7609d91407014d94611912cc2b1a3">read</a>(fd, eth_buffer, len);</div><div class="line">     <a class="code" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#ga1e7463f2ee53d9da5a2ee24121aed25d">ioctl</a>(fd, <a class="code" href="group___e_t_h___d_e_v.html#ga3f92bb99197ca9ce688d4a8b2c54059e">I_ETH_RXPKTCOMPLETE</a>, addr);</div><div class="line"> }</div></div><!-- fragment --> <table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structeth__attr__t.html">eth_attr_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">ETH IO Attributes.  <a href="structeth__attr__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structeth__txstatus__t.html">eth_txstatus_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga22dd39cc4b68f3f902695d8304dfb387"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___e_t_h___d_e_v.html#ga22dd39cc4b68f3f902695d8304dfb387">I_ETH_GETATTR</a></td></tr>
<tr class="memdesc:ga22dd39cc4b68f3f902695d8304dfb387"><td class="mdescLeft">&#160;</td><td class="mdescRight">See below for details.  <a href="#ga22dd39cc4b68f3f902695d8304dfb387">More...</a><br /></td></tr>
<tr class="separator:ga22dd39cc4b68f3f902695d8304dfb387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba9bc550be16b7fce1fcba528f915d26"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___e_t_h___d_e_v.html#gaba9bc550be16b7fce1fcba528f915d26">I_ETH_SETATTR</a></td></tr>
<tr class="memdesc:gaba9bc550be16b7fce1fcba528f915d26"><td class="mdescLeft">&#160;</td><td class="mdescRight">See below for details.  <a href="#gaba9bc550be16b7fce1fcba528f915d26">More...</a><br /></td></tr>
<tr class="separator:gaba9bc550be16b7fce1fcba528f915d26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c9146612934f92e865882fc6cdfab7e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga1c9146612934f92e865882fc6cdfab7e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___e_t_h___d_e_v.html#ga1c9146612934f92e865882fc6cdfab7e">I_ETH_INITTXPKT</a></td></tr>
<tr class="memdesc:ga1c9146612934f92e865882fc6cdfab7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This request starts a new packet (to be transmitted). Subsequent calls to <a class="el" href="group___u_n_i___f_i_l_e___a_c_c_e_s_s.html#gadd30ddeed4bdbf3c96fa36970c1ca778">write()</a> will store data in the new packet. The I_ETH_SENDTXPKT request will send the packet. The ctl argument is NULL. <br /></td></tr>
<tr class="separator:ga1c9146612934f92e865882fc6cdfab7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf49e4783348012ba8cd1abe757e66f5a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf49e4783348012ba8cd1abe757e66f5a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___e_t_h___d_e_v.html#gaf49e4783348012ba8cd1abe757e66f5a">I_ETH_SENDTXPKT</a></td></tr>
<tr class="memdesc:gaf49e4783348012ba8cd1abe757e66f5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This request transmits the current packet in the transmit buffer. It returns 0 if the packet was successfully transmitted. <br /></td></tr>
<tr class="separator:gaf49e4783348012ba8cd1abe757e66f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f3d0b94907c091d5a5f48ab8b9a67c5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8f3d0b94907c091d5a5f48ab8b9a67c5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___e_t_h___d_e_v.html#ga8f3d0b94907c091d5a5f48ab8b9a67c5">I_ETH_TXPKTBUSY</a></td></tr>
<tr class="memdesc:ga8f3d0b94907c091d5a5f48ab8b9a67c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This request checks to see if there is a packet currently being transmitted. It returns true if a packet is currently being transmitted and false otherwise (less than zero for an error). <br /></td></tr>
<tr class="separator:ga8f3d0b94907c091d5a5f48ab8b9a67c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f87af45b40ab74852e3571e370ccd5a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3f87af45b40ab74852e3571e370ccd5a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___e_t_h___d_e_v.html#ga3f87af45b40ab74852e3571e370ccd5a">I_ETH_RXPKTRDY</a></td></tr>
<tr class="memdesc:ga3f87af45b40ab74852e3571e370ccd5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This request checks to see if a new packet is ready to be read from the device. It returns the number of bytes available in the packet or less than zero for an error. The ctl argument points to a memory destination for the pointer to the next packet. <br /></td></tr>
<tr class="separator:ga3f87af45b40ab74852e3571e370ccd5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f92bb99197ca9ce688d4a8b2c54059e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3f92bb99197ca9ce688d4a8b2c54059e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___e_t_h___d_e_v.html#ga3f92bb99197ca9ce688d4a8b2c54059e">I_ETH_RXPKTCOMPLETE</a></td></tr>
<tr class="memdesc:ga3f92bb99197ca9ce688d4a8b2c54059e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This request finalizes the reception of a packet. The ctl value is a pointer to the next packet address in the read buffer. This value is obtained when a packet is ready using the I_ETH_RXPKTRDY request. <br /></td></tr>
<tr class="separator:ga3f92bb99197ca9ce688d4a8b2c54059e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga22dd39cc4b68f3f902695d8304dfb387"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_ETH_GETATTR</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This requests reads the ADC attributes.</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;#include &lt;dev/eth.h&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;eth_attr_t attr;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;int eth_fd;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;...</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;ioctl(eth_fd, I_ETH_GETATTR, &amp;attr);</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaba9bc550be16b7fce1fcba528f915d26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_ETH_SETATTR</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This requests writes the ETH attributes.</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;#include &lt;dev/eth.h&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;eth_attr_t attr;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;int eth_fd;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;...</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;ioctl(eth_fd, I_ETH_SETATTR, &amp;attr);</div></div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
