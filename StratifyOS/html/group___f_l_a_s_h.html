---
layout: page
title: Stratify OS Docs
---
{% include JB/setup %}
<script type="text/javascript" src="doxy-boot.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="style.css" rel="stylesheet" type="text/css" />
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">Flash Memory<div class="ingroups"><a class="el" href="group___s_t_f_y.html">Stratify OS</a> &raquo; <a class="el" href="group___i_f_a_c_e___d_e_v.html">Device Interface</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Flash Memory:</div>
<div class="dyncontent">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="group___f_l_a_s_h.svg" width="283" height="35"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</td></tr></table></center>
</div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The flash memory software module allows the user code to read memory in the flash program space. Reading the flash is portable across all supported MCU's. However, writing the flash is dependent on the MCU page size.</p>
<p>This interface is typically only used with the bootloader. The preferred way to access the flash is using the <a class="el" href="group___m_e_m.html">Memory (RAM/Flash)</a> interface. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflash__pageinfo__t.html">flash_pageinfo_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash page info for use with I_FLASH_GETPAGEINFO.  <a href="structflash__pageinfo__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflash__writepage__t.html">flash_writepage_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash page write data using I_FLASH_WRITEPAGE.  <a href="structflash__writepage__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gabbc7be7259603befa91cf82a53635026"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gabbc7be7259603befa91cf82a53635026">FLASH_MIN_WRITE_SIZE</a></td></tr>
<tr class="memdesc:gabbc7be7259603befa91cf82a53635026"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gabbc7be7259603befa91cf82a53635026">More...</a><br /></td></tr>
<tr class="separator:gabbc7be7259603befa91cf82a53635026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae34a1428457cec34e25242f1051a1c08"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gae34a1428457cec34e25242f1051a1c08">FLASH_MAX_WRITE_SIZE</a></td></tr>
<tr class="memdesc:gae34a1428457cec34e25242f1051a1c08"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gae34a1428457cec34e25242f1051a1c08">More...</a><br /></td></tr>
<tr class="separator:gae34a1428457cec34e25242f1051a1c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3269de27e06da94d3563f22fed34ece4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga3269de27e06da94d3563f22fed34ece4">I_FLASH_ERASEADDR</a></td></tr>
<tr class="memdesc:ga3269de27e06da94d3563f22fed34ece4"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga3269de27e06da94d3563f22fed34ece4">More...</a><br /></td></tr>
<tr class="separator:ga3269de27e06da94d3563f22fed34ece4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab0cd3a8e3488ddeec35887ef0c7b6eb1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gab0cd3a8e3488ddeec35887ef0c7b6eb1">I_FLASH_ERASEPAGE</a></td></tr>
<tr class="memdesc:gab0cd3a8e3488ddeec35887ef0c7b6eb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gab0cd3a8e3488ddeec35887ef0c7b6eb1">More...</a><br /></td></tr>
<tr class="separator:gab0cd3a8e3488ddeec35887ef0c7b6eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8680be69eaa74f57f2853d68592811a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga8680be69eaa74f57f2853d68592811a8">I_FLASH_GETPAGE</a></td></tr>
<tr class="memdesc:ga8680be69eaa74f57f2853d68592811a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga8680be69eaa74f57f2853d68592811a8">More...</a><br /></td></tr>
<tr class="separator:ga8680be69eaa74f57f2853d68592811a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb">I_FLASH_GETSIZE</a></td></tr>
<tr class="memdesc:ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb">More...</a><br /></td></tr>
<tr class="separator:ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf80a88a4fe4da955323e71c1a5f821b0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#gaf80a88a4fe4da955323e71c1a5f821b0">I_FLASH_GETPAGEINFO</a></td></tr>
<tr class="memdesc:gaf80a88a4fe4da955323e71c1a5f821b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#gaf80a88a4fe4da955323e71c1a5f821b0">More...</a><br /></td></tr>
<tr class="separator:gaf80a88a4fe4da955323e71c1a5f821b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a6e7b8fae0b172931a6b884351f9d15"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___f_l_a_s_h.html#ga1a6e7b8fae0b172931a6b884351f9d15">I_FLASH_WRITEPAGE</a></td></tr>
<tr class="memdesc:ga1a6e7b8fae0b172931a6b884351f9d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">See details below.  <a href="#ga1a6e7b8fae0b172931a6b884351f9d15">More...</a><br /></td></tr>
<tr class="separator:ga1a6e7b8fae0b172931a6b884351f9d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gae34a1428457cec34e25242f1051a1c08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_MAX_WRITE_SIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This defines the MCU specific value for the maximum write size for a flash operation. </p>

</div>
</div>
<a class="anchor" id="gabbc7be7259603befa91cf82a53635026"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLASH_MIN_WRITE_SIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This defines the MCU specific value for the minimum write size. This is also the minimum step and alignment size for writing the flash. </p>

</div>
</div>
<a class="anchor" id="ga3269de27e06da94d3563f22fed34ece4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_ERASEADDR</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request erases the page containing the specified address. The address is specified as the ctl argument.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;ioctl(flash_fd, I_FLASH_ERASEADDR, (void*)0x00001000 );</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gab0cd3a8e3488ddeec35887ef0c7b6eb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_ERASEPAGE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request erases the page number specified by the ctl argument.</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;ioctl(flash_fd, I_FLASH_ERASEPAGE, 3); //erase page 3</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga8680be69eaa74f57f2853d68592811a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_GETPAGE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request gets the page number for the specified address. The ctl argument is the address and the return value is the page.</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int page;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;page = ioctl(flash_fd, I_FLASH_GETPAGE, (void*)0x00001000 );</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gaf80a88a4fe4da955323e71c1a5f821b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_GETPAGEINFO</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request gets the page number for the specified address. The ctl argument is the address and the return value is the page.</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;flash_pageinfo_t pageinfo;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;page = ioctl(flash_fd, I_FLASH_GETPAGEINFO, &amp;pageinfo );</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga00c5aa5b9e7ecba1ca01c30d3c3c1ffb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_GETSIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request gets the page number for the specified address. The ctl argument is the address and the return value is the page.</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;int page;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;size = ioctl(flash_fd, I_FLASH_GET_PAGE);</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="ga1a6e7b8fae0b172931a6b884351f9d15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I_FLASH_WRITEPAGE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This request is used to write a page to the flash memory. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;flash_writepage_t pwrite;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;pwrite.addr = 0x1000; //this should be on a boundary for the minimum page size</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;pwrite.nbyte = 256;  //This has to be a valid page write value for the architecture</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;memcpy(pwrite.buf, my_data, pwrite.nbyte);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;ioctl(flash_fd, I_FLASH_WRITEPAGE, &amp;pwrite);</div></div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
